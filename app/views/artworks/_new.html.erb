<div class="artwork-new">
	<p> Vous vous apprêtez à créer une oeuvre qui n'apparaît pas sur la carte. </p>
	<p> Pour ajouter une photo d'une oeuvre existante, retournez sur la page de la carte. </p>

	<%= form_tag (artworks_path) do %>
	<% if @artwork.errors.any? %>
	<div id="error_explanation">
	  <h2>
	    <%= pluralize(@artwork.errors.count, "error") %> prohibited
	    this user from being saved:
	  </h2>
	    <% @artwork.errors.full_messages.each do |msg| %>
	      <p><%= msg %></p>
	    <% end %>
	</div>
	<% end %>

	<div class="field input" >
	  <%= label_tag "nom", "Nom de l'œuvre (si vous le connaissez)" %>
	  <br>
	  <%= text_field_tag(:title) %>
	</div>
	<br>
	<div class="field input">
	  <%= label_tag 'artist', "Nom de l'artiste (si vous le connaissez)"  %>
	  <br>
	  <%= text_field_tag(:description) %>
	</div>
	<div class="field input" style="display: none">
	  <%= label_tag 'lat', "Latitude"  %>
	  <%= text_field_tag :lat, id:"lat" %>
	</div>
	<div class="field input" style="display:none">
	  <%= label_tag 'long', "Longitude"  %>
	  <%= text_field_tag :long, id:"long" %>
	</div>
	<%= submit_tag 'Valider', class: "btn btn-primary", id:"submit-artwork"%>
	<% end %>
</div>

<div class="picture-new" style="display: none">
</div>


<script type="text/javascript">

console.log(sessionStorage.getItem('lat') + ", " + sessionStorage.getItem('lng'));

// We start by getting current user location

document.getElementById("lat").value = sessionStorage.getItem('lat');
document.getElementById("long").value = sessionStorage.getItem('lng');

// If we manage to get it, we show the new artwork submit button
//$("#submit-artwork").show();
//};

//function error(err) {
 // alert("Oups... Nous n'avons pas réussi à vous géolocaliser. Veillez à bien activer votre géolocalisation pour pouvoir ajouter une oeuvre !");
//};

//})();

// We put an ajax request under the submit button to open the new-picture form
$("#submit-artwork").on("click", function(event){
	event.preventDefault();
	$(".artwork-new").hide();
    $.ajax({
        type: "GET",
        contentType: "application/script; charset=utf-8",
        //dataType: "text",
        url: "/pictures/new/"
        //complete: function(content){
    	//	content.then(function(plop){ console.log(plop)})
    	//}
    });
	event.preventDefault();

});

// If we click on the map, the form is hidden
$(".body-container").on("click", function(){
  $(".popup-form").hide();
});



</script>
